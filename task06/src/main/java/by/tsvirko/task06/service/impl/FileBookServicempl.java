package by.tsvirko.task06.service.impl;import by.tsvirko.task06.dao.exception.BookStorageElementException;import by.tsvirko.task06.entity.Book;import by.tsvirko.task06.repository.BookRepository;import by.tsvirko.task06.repository.factory.RepositoryFactory;import by.tsvirko.task06.service.BookService;import by.tsvirko.task06.service.FileBookService;import by.tsvirko.task06.service.factory.ServiceFactory;import org.apache.logging.log4j.LogManager;import org.apache.logging.log4j.Logger;import java.io.*;import java.util.ArrayList;import java.util.HashSet;import java.util.List;import java.util.Set;public class FileBookServicempl implements FileBookService {    private RepositoryFactory repositoryFactory = RepositoryFactory.getInstance();    private final String FILE_PATH = "Books";    //TODO: logger    private static final Logger logger = LogManager.getLogger(FileBookServicempl.class);    @Override    public List<Book> read() throws IOException, ClassNotFoundException {        List<Book> books = new ArrayList<>();        FileInputStream fis = null;        try {            fis = new FileInputStream(new File(FILE_PATH));            while (true) {                ObjectInputStream ois = new ObjectInputStream(fis);                books.add((Book) ois.readObject());            }        } catch (EOFException ignored) {        } finally {            if (fis != null)                fis.close();        }        return books;    }    @Override    public void write(Book book) throws IOException {        try {            FileOutputStream f = new FileOutputStream(new File(FILE_PATH), true);            ObjectOutputStream o = new ObjectOutputStream(f);            o.writeObject(book);            o.close();            f.close();        } catch (FileNotFoundException e) {            throw new FileNotFoundException("file does not exist");        } catch (IOException e) {            throw new IOException("Error initializing stream");        }    }    @Override    public void writeRandom() throws IOException, BookStorageElementException, ClassNotFoundException {        BookRepository bookRepository = repositoryFactory.getBookRepository();        Set<String> harry = new HashSet<>();        harry.add("J.K.Rowling");        Book book = new Book("Harry Potter", harry, 10000, "USA House", 2000);        Set<String> warAndPiece = new HashSet<>();        warAndPiece.add("Tolstoy");        Book book1 = new Book("War and piece", warAndPiece, 1225, "unknown", 1865);        //TODO: add logSet<String> warAndPiece = new HashSet<>();        Set<String> q = new HashSet<>();        q.add("q");        Book book2 = new Book("q", q, 1, "q", 1);        write(book);        write(book1);        write(book2);        BookService bookService = new BookServiceImpl();        bookService.initBookStorageFromFile();    }////    public static void main(String[] args) {////        FileBookRepositorympl fileBookDao = new FileBookRepositorympl();////        Set<String> strings = new HashSet<>();//        strings.add("LO");//        strings.add("OL");////        Book book = new Book("aaa", strings, 9, "LI", 2000);//        Book book1 = new Book("kkk", strings, 10, "LI", 2001);//        try {//            fileBookDao.write(book);//            fileBookDao.write(book1);////            List<Book> b = fileBookDao.read();//            for (Book book2 : b) {//                System.out.println(book2);//            }////        } catch (IOException | ClassNotFoundException e) {//            e.printStackTrace();//        }//    }}